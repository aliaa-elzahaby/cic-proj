xwrh wmln ckzg mfys









create   Nodejs  Application

Dockerize  apllication

push to docker hub

create  deployment  and service

test application in  browser






..  downlowd node js


node  --version 

npm  --version



npm  init -y      ...>  will create package.json file

npm  install  express



...>  and create new file with name of  index.mjs



...>>   on  vs code index.mjs


import  express from 'express'
import os from 'os'


const  app = express()
const PORT =3000

app.get("/", (req,res)=>{
       const message='hello world,i am pod${os.hostname()}'
       res.send(message)

})

app.listen(PORT,()=>{
        console.log('web server is listening at port ${PORT}'
        console.log(os.hostname())
})


            >>>>>>>>>>>>>>>>


node  index.mjs



...>  create docker file

FROM  node:alpine

WORKDIR   /app


EXPOSE  3000

COPY   package.json   package-lock.json  ./

RUN  npm  install


COPY  . ./

CMD [ "npm" , "start"]
 

          >>>>>>>>>>>>>>>>



and go to package.json   and change tests in scripts  to 
 "start":  "node  index.mjs"


npm start


docker build . -t aliaaahmed432/k8s-web-server-cic:latest



docker image ls


docker login

docker push  aliaaahmed432/k8s-web-server-cic:latest



kubectl   get all

kubectl create deployment k8s-web-server --image=aliaaahmed432/k8s-web-server-cic:latest

kubectl   get all




kubectl   expose  deployment   k8s-web-server   --port=3000

kubectl   get  svc

kubectl   get deploy  


kubectl  scale   deployment   k8s-web-server   --replicas=6


kubectl   get all


kubectl  get pods   -o  wide

minikube  ssh


curl   ip.......:3000


kubectl   delete  svc    k8s-web-server


kubectl   expose  deployment   k8s-web-server  --type=nodeport   --port=3000

kubectl   get  services


minikube   service  k8s-web-server



>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>



npm start


docker build . -t aliaaahmed432/k8s-web-server-cic:latest



docker image ls


docker login

docker push  aliaaahmed432/k8s-web-server-cic:latest



git init
git add .
git commit -m "my nodejs docker project"
git remote add origin https://github.com/aliaa-elzahaby/cic-proj.git
git push -u origin main



docker ps   # list running containers
docker stop   60bf291fe225
docker rm    60bf291fe225

docker run -d -p 3000:3000 aliaaahmed432/k8s-web-server-cic:latest



 ###  deployment.yaml


apiVersion: apps/v1
kind: Deployment
metadata:
  name: web-server-deployment
  labels:
    app: web-server
spec:
  replicas: 1
  selector:
    matchLabels:
      app: web-server
  template:
    metadata:
      labels:
        app: web-server
    spec:
      containers:
      - name: web-server
        image: aliaaahmed432/k8s-web-server-cic:latest
        ports:
        - containerPort: 3000
---
apiVersion: v1
kind: Service
metadata:
  name: web-server-service
spec:
  type: NodePort   # Expose externally via minikube service
  selector:
    app: web-server
  ports:
    - port: 3000
      targetPort: 3000
      nodePort: 30080   # Exposed on <minikube-ip>:30080


              >>>>>>>>>>>>>>>>>>


kubectl apply -f deployment.yaml


kubectl get pods
kubectl get svc

minikube service web-server-service





minikube image load aliaaahmed432/k8s-web-server-cic:latest


kubectl get events --sort-by=.metadata.creationTimestamp

kubectl get svc web-server-service

minikube service web-server-service







